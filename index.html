<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo App</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

  <link href="style.css" rel="stylesheet">

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>


</head>
<body>
  <!-- Login Page -->
  <div id="loginPage" class="container">
    <h2 class="text-center mb-4">Login</h2>
    <form id="loginForm">
      <div class="form-group">
        <label for="username">Username</label>
        <input type="text" class="form-control" id="username" placeholder="Enter username" autocomplete="username">
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" class="form-control" id="password" placeholder="Enter password">
      </div>
      <button type="submit" class="btn btn-primary btn-block">Login</button>
    </form>
  </div>

  <!-- Main Page -->
  <div id="mainPage" class="container" style="display: none;">
    <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
      <a class="navbar-brand" href="#">Todo App</a>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#" id="todoListLink">Todo List</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" id="logoutLink">Logout</a>
          </li>
        </ul>
      </div>
    </nav>
    <div id="content">
      <!-- Content will be loaded dynamically -->
    </div>
  </div>

  <!-- Bootstrap JS and jQuery (required for Bootstrap and AJAX) -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


  

  <script>
    var completedCount = 0; // Counter for completed tasks

  // Function to fetch todo list data
  function fetchTodoList() {
    return new Promise(function(resolve, reject) {
      $.ajax({
        url: "https://jsonplaceholder.typicode.com/todos",
        method: "GET",
        success: function(data) {
          resolve(data);
        },
        error: function(xhr, status, error) {
          reject(error);
        }
      });
    });
  }

      
    $(document).ready(function() {
      var prevCompletedCount = 0; // Counter for previously completed tasks

      // Check if the user is already logged in
      var loggedIn = sessionStorage.getItem("loggedIn");
      if (loggedIn === "true") {
        showMainPage();
      }

      // Login form submission
      $("#loginForm").submit(function(event) {
        event.preventDefault();
        var username = $("#username").val();
        var password = $("#password").val();
        if (username === "admin" && password === "12345") {
          sessionStorage.setItem("loggedIn", "true");
          showMainPage();
        } else {
          alert("Invalid username or password. Please try again.");
        }
      });

      // Logout link click
      $("#logoutLink").click(function(event) {
        event.preventDefault();
        sessionStorage.removeItem("loggedIn");
        $("#mainPage").hide();
        $("#loginPage").show();
      });

      // Todo List link click
      $("#todoListLink").click(function(event) {
        event.preventDefault();
        fetchTodoList().then(function(todoList) {
          // Reset completed count and display the todo list
          completedCount = 0;
          prevCompletedCount = 0;
          displayTodoList(todoList);
        }).catch(function(error) {
          console.error('Error fetching todo list:', error);
          alert("An error occurred while fetching the todo list. Please try again later.");
        });
      });

      // Fetch todo list data and initialize completedCount
      fetchTodoList().then(function(todoList) {
        // Count the number of completed tasks
        completedCount = todoList.filter(function(todo) {
          return todo.completed;
        }).length;

        // Display the todo list
        displayTodoList(todoList);
      }).catch(function(error) {
        console.error('Error fetching todo list:', error);
        alert("An error occurred while fetching the todo list. Please try again later.");
      });
      // Function to show main page
      function showMainPage() {
        $("#loginPage").hide();
        $("#mainPage").show();
      }

      
  // Function to handle checkbox change event
  $("#content").on("change", "input[type='checkbox']", function() {
    var $tr = $(this).closest("tr");
    var status = this.checked ? "Completed" : "";
    var wasCompleted = $tr.hasClass("completed"); // Check if task was previously completed
    $tr.find(".status").text(status);
    if (status === "Completed" && !wasCompleted) { // Increment count only if task was not previously completed
      completedCount++;
    } else if (status !== "Completed" && wasCompleted) { // Decrement count if task was previously completed and now unchecked
      completedCount--;
    }

    // Check if exactly 5 tasks have been completed
    if (completedCount === 5) {
      alert("Congrats! You have completed 5 tasks successfully.");
    }
  });

      // Function to display todo list
      function displayTodoList(todoList) {
    var $content = $("#content");
    $content.empty();
    var $table = $("<table>").addClass("table");
    var $thead = $("<thead>").append("<tr><th>Task</th><th>Status</th><th>Completed</th></tr>");
    var $tbody = $("<tbody>");
    todoList.forEach(function(todo) {
      var $tr = $("<tr>");
      var $checkbox = $("<input>").attr("type", "checkbox").addClass("mr-2");
      var $status = $("<span>").addClass("status").text(todo.completed ? "Completed" : "");
      if (todo.completed) {
        $checkbox.prop("checked", true).prop("disabled", true);
      }
      $tr.append($("<td>").text(todo.title), $("<td>").append($status), $("<td>").append($checkbox));
      $tbody.append($tr);
    });
    $table.append($thead, $tbody);
    $content.append($table);
  }
});
  
  </script>


  
</body>
</html>
